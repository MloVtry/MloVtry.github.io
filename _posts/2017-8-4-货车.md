---
layout: post
title: Luogu&#x8D27;&#x8F66;&#x8FD0;&#x8F93;
category : Intro 
tags : [tag1]
---

## &#x8D27;&#x8F66;&#x8FD0;&#x8F93;

## &#x9898;&#x76EE;&#x63CF;&#x8FF0;

A &#x56FD;&#x6709; n &#x5EA7;&#x57CE;&#x5E02;&#xFF0C;&#x7F16;&#x53F7;&#x4ECE; 1 &#x5230; n&#xFF0C;&#x57CE;&#x5E02;&#x4E4B;&#x95F4;&#x6709; m &#x6761;&#x53CC;&#x5411;&#x9053;&#x8DEF;&#x3002;&#x6BCF;&#x4E00;&#x6761;&#x9053;&#x8DEF;&#x5BF9;&#x8F66;&#x8F86;&#x90FD;&#x6709;&#x91CD;&#x91CF;&#x9650;&#x5236;&#xFF0C;&#x7B80;&#x79F0;&#x9650;&#x91CD;&#x3002;&#x73B0;&#x5728;&#x6709; q &#x8F86;&#x8D27;&#x8F66;&#x5728;&#x8FD0;&#x8F93;&#x8D27;&#x7269;&#xFF0C; &#x53F8;&#x673A;&#x4EEC;&#x60F3;&#x77E5;&#x9053;&#x6BCF;&#x8F86;&#x8F66;&#x5728;&#x4E0D;&#x8D85;&#x8FC7;&#x8F66;&#x8F86;&#x9650;&#x91CD;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6700;&#x591A;&#x80FD;&#x8FD0;&#x591A;&#x91CD;&#x7684;&#x8D27;&#x7269;&#x3002;

## &#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;

&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;

&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x540D;&#x4E3A; truck.in&#x3002;

&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x7B2C;&#x4E00;&#x884C;&#x6709;&#x4E24;&#x4E2A;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#x7684;&#x6574;&#x6570; n&#xFF0C;m&#xFF0C;&#x8868;&#x793A; A &#x56FD;&#x6709; n &#x5EA7;&#x57CE;&#x5E02;&#x548C; m &#x6761;&#x9053;

&#x8DEF;&#x3002; &#x63A5;&#x4E0B;&#x6765; m &#x884C;&#x6BCF;&#x884C; 3 &#x4E2A;&#x6574;&#x6570; x&#x3001; y&#x3001; z&#xFF0C;&#x6BCF;&#x4E24;&#x4E2A;&#x6574;&#x6570;&#x4E4B;&#x95F4;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#xFF0C;&#x8868;&#x793A;&#x4ECE; x &#x53F7;&#x57CE;&#x5E02;&#x5230; y &#x53F7;&#x57CE;&#x5E02;&#x6709;&#x4E00;&#x6761;&#x9650;&#x91CD;&#x4E3A; z &#x7684;&#x9053;&#x8DEF;&#x3002;&#x6CE8;&#x610F;&#xFF1A; x &#x4E0D;&#x7B49;&#x4E8E; y&#xFF0C;&#x4E24;&#x5EA7;&#x57CE;&#x5E02;&#x4E4B;&#x95F4;&#x53EF;&#x80FD;&#x6709;&#x591A;&#x6761;&#x9053;&#x8DEF; &#x3002;

&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x884C;&#x6709;&#x4E00;&#x4E2A;&#x6574;&#x6570; q&#xFF0C;&#x8868;&#x793A;&#x6709; q &#x8F86;&#x8D27;&#x8F66;&#x9700;&#x8981;&#x8FD0;&#x8D27;&#x3002;

&#x63A5;&#x4E0B;&#x6765; q &#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E24;&#x4E2A;&#x6574;&#x6570; x&#x3001;y&#xFF0C;&#x4E4B;&#x95F4;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#xFF0C;&#x8868;&#x793A;&#x4E00;&#x8F86;&#x8D27;&#x8F66;&#x9700;&#x8981;&#x4ECE; x &#x57CE;&#x5E02;&#x8FD0;&#x8F93;&#x8D27;&#x7269;&#x5230; y &#x57CE;&#x5E02;&#xFF0C;&#x6CE8;&#x610F;&#xFF1A; x &#x4E0D;&#x7B49;&#x4E8E; y &#x3002;

&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;

&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x540D;&#x4E3A; truck.out&#x3002;

&#x8F93;&#x51FA;&#x5171;&#x6709; q &#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x8F86;&#x8D27;&#x8F66;&#xFF0C;&#x5B83;&#x7684;&#x6700;&#x5927;&#x8F7D;&#x91CD;&#x662F;&#x591A;&#x5C11;&#x3002;&#x5982;&#x679C;&#x8D27;

&#x8F66;&#x4E0D;&#x80FD;&#x5230;&#x8FBE;&#x76EE;&#x7684;&#x5730;&#xFF0C;&#x8F93;&#x51FA;-1&#x3002;


## &#x601D;&#x8DEF;&#xFF1A;

&#x6700;&#x5927;&#x751F;&#x6210;&#x6811;+lca

&#x9996;&#x5148;&#x53EF;&#x4EE5;&#x7528;&#x6700;&#x5927;&#x751F;&#x6210;&#x6811;get&#x4E00;&#x53EA;&#x6811;&#xFF0C;&#x663E;&#x7136;&#xFF0C;&#x6CBF;&#x7740;&#x6811;&#x4E0A;&#x7684;&#x8DEF;&#x5F84;&#x7684;&#x8DEF;&#x5F84;&#x8D70;&#x4E00;&#x5B9A;&#x662F;&#x6700;&#x5C0F;&#x503C;&#x6700;&#x5927;&#x7684;

&#x6811;&#x4E0A;&#x8DEF;&#x5F84;&#x81EA;&#x7136;&#x5C31;&#x662F;lca&#x4E86;&#xFF0C;&#x8FD9;&#xFF08;&#x53EA;&#xFF09;&#x91CC;&#xFF08;&#x4F1A;&#xFF09;&#x500D;&#x589E;&#xFF0C;&#x9664;&#x4E86;&#x500D;&#x589E;&#x7528;&#x7684;&#x7956;&#x5148;&#x8FD8;&#x7EDF;&#x8BA1;&#x4E86;&#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x6700;&#x5C0F;&#x503C;&#xFF08;&#x4E00;&#x4E2A;s&#x4E00;&#x4E2A;t&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x67E5;&#x8BE2;lca&#x987A;&#x5E26;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x6700;&#x5C0F;&#x503C;&#x5C31;&#x597D;&#x4E86;



```cpp 
#include<algorithm>
#include<iostream>
#include<cstdio>
#define N 10010
#define M 50010*4
#define inf 1<<30
using namespace std;
struct eage
{
    int u,v,l;
}a[M];
bool comp(eage aa,eage bb)
{
    return aa.l>bb.l;
}
int e,n,m,q,t[N][20],s[N][20];
int dep[N],f[N],num[N],head[N],to[M],next[M],len[M];
int get_f(int now)
{
    if(now==f[now]) return f[now];
    else return f[now]=get_f(f[now]);
}
void buid(int u,int v,int l)
{
    next[++e]=head[u],head[u]=e;
    to[e]=v,len[e]=l;
}
void join(int u,int v)
{
    if(num[u]>num[v]) swap(u,v);
    f[u]=f[v];
    num[v]+=num[u];
}
void dfs(int now,int fa,int l,int dp)
{
    dep[now]=dp;
    s[now][0]=fa;
    t[now][0]=l;
    for(int i=head[now];i;i=next[i])
    {
        int j=to[i];
        if(j!=fa)
        {
            dfs(j,now,len[i],dp+1);
        }
    }
}
void do_st()
{
    for(int j=1;j<=15;j++)
        for(int i=1;i<=n;i++)
            s[i][j]=s[s[i][j-1]][j-1];
    for(int j=1;j<=15;j++)
        for(int i=1;i<=n;i++)
            t[i][j]=min(t[i][j-1],t[s[i][j-1]][j-1]);
}
int ask(int u,int v)
{
    int re=inf;
    if(dep[u]<dep[v]) swap(u,v);
    //u>v
    int c=dep[u]-dep[v];
    for(int i=0;i<=15;++i)
    {
        if(c&(1<<i))
        {
            re=min(re,t[u][i]);
            u=s[u][i];
        }
    }
    if(u==v) return re;
    for(int i=15;i>=0;i--)
    {
        if(s[u][i]!=s[v][i])
        {
            re=min(t[u][i],re);
            re=min(t[v][i],re);
            u=s[u][i];
            v=s[v][i];
        }
    }
    re=min(t[u][0],re);
    re=min(t[v][0],re);
    return re;
}
int main()
{
    scanf("%d%d",&n,&m);
    for(int i=1;i<=m;++i)
    {
        scanf("%d%d%d",&a[i].u,&a[i].v,&a[i].l);
    }
    sort(a+1,a+m+1,comp);
    for(int i=1;i<=n;++i) f[i]=i,num[i]=1;
    for(int i=1;i<=m;++i)
    {
        int fa=get_f(a[i].u),fb=get_f(a[i].v);
        if(fa==fb) continue;
        join(fa,fb);
        buid(a[i].u,a[i].v,a[i].l);
        buid(a[i].v,a[i].u,a[i].l);
    }
    dfs(1,0,inf,1);
    do_st();
    scanf("%d",&q);
    for(int i=1;i<=q;++i)
    {
        int u,v;
        scanf("%d%d",&u,&v);
        if(get_f(u)!=get_f(v))
        {
            printf("-1\n");
            continue;
        }
        printf("%d\n",ask(u,v));
    }
    return 0;
}
``` 
