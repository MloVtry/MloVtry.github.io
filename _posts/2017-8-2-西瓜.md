---
layout: post
title: Luogu&#x51B0;&#x7CBE;&#x51BB;&#x897F;&#x74DC;
category : Intro 
tags : [tag1]
---

## &#x51B0;&#x7CBE;&#x51BB;&#x897F;&#x74DC;
&#x9898;&#x76EE;&#x63CF;&#x8FF0;

&#x742A;&#x9732;&#x8BFA;&#x662F;&#x62E5;&#x6709;&#x64CD;&#x7EB5;&#x51B7;&#x6C14;&#x7A0B;&#x5EA6;&#x7684;&#x80FD;&#x529B;&#x7684;&#x5996;&#x7CBE;&#xFF0C;&#x4E00;&#x5929;&#x5979;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x7247;&#x897F;&#x74DC;&#x5730;&#x3002;&#x8FD9;&#x91CC;&#x6709;n&#x4E2A;&#x897F;&#x74DC;&#xFF0C;&#x7531;n-1&#x6761;&#x897F;&#x74DC;&#x8513;&#x8FDE;&#x63A5;&#xFF0C;&#x5F62;&#x6210;&#x4E00;&#x4E2A;&#x6709;&#x6839;&#x6811;&#xFF0C;&#x742A;&#x9732;&#x8BFA;&#x60F3;&#x8981;&#x628A;&#x5B83;&#x4EEC;&#x51B7;&#x51BB;&#x8D77;&#x6765;&#x6162;&#x6162;&#x5403;&#x3002;

&#x8FD9;&#x4E9B;&#x897F;&#x74DC;&#x8513;&#x5177;&#x6709;&#x795E;&#x5947;&#x7684;&#x6027;&#x8D28;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x7ECF;&#x8FC7;&#x5B83;&#x7684;&#x51B7;&#x6C14;&#x7684;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x653E;&#x5927;&#x6216;&#x7F29;&#x5C0F;&#xFF0C;&#x6BCF;&#x6761;&#x897F;&#x74DC;&#x8513;&#x653E;&#x5927;/&#x7F29;&#x5C0F;&#x51B7;&#x6C14;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x7684;&#x80FD;&#x529B;&#x503C;&#x4E3A;Wi&#xFF0C;&#x8868;&#x793A;&#x51B7;&#x6C14;&#x7ECF;&#x8FC7;&#x5B83;&#x540E;&#xFF0C;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x503C;x&#x4F1A;&#x53D8;&#x4E3A;x*wi&#x3002;&#x6BCF;&#x4E2A;&#x897F;&#x74DC;&#x4E5F;&#x6709;&#x4E00;&#x4E2A;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x503C;&#xFF0C;&#x708E;&#x70ED;&#x7684;&#x590F;&#x65E5;&#xFF0C;&#x6240;&#x6709;&#x897F;&#x74DC;&#x7684;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x503C;&#x521D;&#x59CB;&#x90FD;&#x4E3A;0&#x3002;

&#x742A;&#x9732;&#x8BFA;&#x4F1A;&#x505A;&#x51FA;&#x4E24;&#x79CD;&#x52A8;&#x4F5C;:

&#x2460;.&#x5BF9;&#x7740;&#x897F;&#x74DC;i&#x653E;&#x51FA;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x4E3A;x&#x7684;&#x51B7;&#x6C14;&#x3002;&#x8FD9;&#x80A1;&#x51B7;&#x6C14;&#x987A;&#x7740;&#x897F;&#x74DC;&#x8513;&#x5411;&#x201C;&#x897F;&#x74DC;&#x6811;&#x201D;&#x7684;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x8513;&#x5EF6;&#xFF0C;&#x51B7;&#x6C14;&#x7684;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x4F1A;&#x6309;&#x7167;&#x4E0A;&#x9762;&#x7684;&#x89C4;&#x5219;&#x53D8;&#x5316;&#x3002;&#x9047;&#x5230;&#x4E00;&#x4E2A;&#x897F;&#x74DC;&#x8FDE;&#x4E86;&#x591A;&#x6761;&#x897F;&#x74DC;&#x8513;&#x65F6;&#xFF0C;&#x6BCF;&#x6761;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x65B9;&#x5411;&#x7684;&#x897F;&#x74DC;&#x8513;&#x5747;&#x4F1A;&#x83B7;&#x5F97;&#x4E0E;&#x539F;&#x5148;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x76F8;&#x7B49;&#x7684;&#x51B7;&#x6C14;&#x3002;&#x9014;&#x5F84;&#x7684;&#x6240;&#x6709;&#x897F;&#x74DC;&#x7684;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x503C;&#x90FD;&#x4F1A;&#x52A0;&#x4E0A;&#x51B7;&#x6C14;&#x7684;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x503C;&#x3002;

&#x2468;.&#x5411;&#x4F60;&#x8BE2;&#x95EE;&#x897F;&#x74DC;i&#x7684;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x503C;&#x662F;&#x591A;&#x5C11;&#x3002;

&#x7B49;&#x7B49;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x6709;&#x2468;&#xFF1F;&#x56E0;&#x4E3A;&#x7B28;&#x86CB;&#x742A;&#x9732;&#x8BFA;&#x81EA;&#x5DF1;&#x4E5F;&#x4F1A;&#x5FD8;&#x8BB0;&#x653E;&#x4E86;&#x591A;&#x5C11;&#x51B0;&#x5462;&#x3002;

&#x6240;&#x4EE5;&#xFF0C;&#x5E2E;&#x5979;&#x8BA1;&#x7B97;&#x7684;&#x4EFB;&#x52A1;&#x5C31;&#x8FD9;&#x4E48;&#x4EA4;&#x7ED9;&#x4F60;&#x5566;&#x3002;

&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;

&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;
&#x7B2C;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x6574;&#x6570;n,&#x8868;&#x793A;&#x897F;&#x74DC;&#x7684;&#x6570;&#x91CF;&#x3002;

&#x897F;&#x74DC;&#x7F16;&#x53F7;&#x4E3A;1~n&#xFF0C;1&#x4E3A;&#x8FD9;&#x68F5;&#x201C;&#x897F;&#x74DC;&#x6811;&#x201D;&#x7684;&#x6839;&#x3002;

&#x63A5;&#x4E0B;&#x6765;n-1&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x6709;&#x4E24;&#x4E2A;&#x6574;&#x6570;u,v&#x548C;&#x4E00;&#x4E2A;&#x5B9E;&#x6570;w&#xFF0C;&#x8868;&#x793A;&#x897F;&#x74DC;u&#x548C;&#x897F;&#x74DC;v&#x4E4B;&#x95F4;&#x8FDE;&#x63A5;&#x6709;&#x4E00;&#x6761;&#x85E4;&#x8513;&#xFF0C;&#x5B83;&#x653E;&#x5927;/&#x7F29;&#x5C0F;&#x51B7;&#x6C14;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x7684;&#x80FD;&#x529B;&#x503C;&#x4E3A;w&#x3002;

&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x6574;&#x6570;m&#xFF0C;&#x8868;&#x793A;&#x64CD;&#x4F5C;&#x7684;&#x6570;&#x91CF;&#x3002;

&#x63A5;&#x4E0B;&#x6765;m&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E24;&#x4E2A;&#x6216;&#x4E09;&#x4E2A;&#x6574;&#x6570;&#x3002;

&#x7B2C;&#x4E00;&#x4E2A;&#x6570;&#x53EA;&#x80FD;&#x662F;1&#x6216;9&#x3002;

&#x5982;&#x679C;&#x4E3A;1&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x4E2A;&#x6574;&#x6570;i&#x548C;&#x4E00;&#x4E2A;&#x5B9E;&#x6570;x&#xFF0C;&#x8868;&#x793A;&#x5BF9;&#x897F;&#x74DC;i&#x653E;&#x51FA;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x4E3A;x&#x7684;&#x51B7;&#x6C14;&#x3002;

&#x5982;&#x679C;&#x4E3A;9&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x4E2A;&#x6574;&#x6570;i&#xFF0C;&#x8868;&#x793A;&#x8BE2;&#x95EE;&#x7F16;&#x53F7;&#x4E3A;i&#x7684;&#x897F;&#x74DC;&#x7684;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x503C;&#x3002;

&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;
&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x64CD;&#x4F5C;&#x2468;&#xFF0C;&#x8F93;&#x51FA;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x5B9E;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x5BF9;&#x5E94;&#x897F;&#x74DC;&#x7684;&#x5BD2;&#x51B7;&#x7A0B;&#x5EA6;&#x503C;&#x3002;

&#x5F3A;&#x884C;&#x6811;&#x72B6;&#x6570;&#x7EC4;
&#x5BF9;&#x4E00;&#x9897;&#x5B50;&#x6811;&#x64CD;&#x4F5C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8054;&#x60F3;&#x5230;&#x533A;&#x95F4;&#x5904;&#x7406;
&#x90A3;&#x4E48;&#xFF0C;&#x5C31;&#x8981;&#x5BF9;&#x6811;&#x91CD;&#x65B0;&#x7F16;&#x7801;&#xFF0C;&#x8BA9;&#x4E00;&#x9897;&#x5B50;&#x6811;&#x6620;&#x5C04;&#x5230;&#x4E00;&#x6BB5;&#x8FDE;&#x7EED;&#x7684;&#x533A;&#x95F4;&#x4E0A;
&#x9047;&#x5230;&#x4E00;&#x4E2A;&#x8FB9;&#x6743;&#x4E3A;0&#x7684;&#x8FB9;&#xFF0C;&#x90A3;&#x4E48;&#x51B7;&#x6C14;&#x4F1A;&#x5728;&#x8FD9;&#x91CC;&#x4E2D;&#x65AD;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x4ECE;&#x8FD9;&#x91CC;&#x65AD;&#x5F00;&#xFF0C;&#x65B0;&#x5EFA;&#x4E00;&#x9897;&#x6811;
&#x8FD9;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x5F97;&#x5230;&#x4E86;&#x68EE;&#x6797;
&#x5982;&#x679C;&#x6240;&#x6709;&#x7684;&#x51B7;&#x6C14;&#x90FD;&#x4ECE;&#x67D0;&#x9897;&#x6811;&#x7684;&#x6811;&#x6839;&#x91CA;&#x653E;&#xFF0C;&#x90A3;&#x4E48;&#x53EA;&#x8981;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;[&#x4ECE;&#x8BE5;&#x70B9;&#x5230;&#x6811;&#x6839;&#x7684;&#x8FB9;&#x6743;&#x79EF;,&#x7528;k&#x8868;&#x793A;]&#xFF0C;&#x5C31;&#x80FD;&#x591F;&#x65B9;&#x4FBF;&#x7684;&#x6C42;&#x51FA;&#x67D0;&#x68F5;&#x5B50;&#x6811;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x70B9;&#x7684;&#x5BD2;&#x51B7;&#x503C;&#xFF1A;&#x533A;&#x95F4;&#x6C42;&#x548C;&#xFF0C;&#x6C42;&#x51FA;&#x8BE5;&#x70B9;&#x7684;&#x6839;&#x91CA;&#x653E;&#x4E86;&#x591A;&#x5C11;&#x51B7;&#x6C14;&#xFF0C;&#x518D;&#x4E58;&#x4E0A;&#x53BB;&#x5C31;&#x597D;&#x4E86;
&#x6240;&#x4EE5;&#x5BF9;&#x4E8E;&#x4E0D;&#x662F;&#x4ECE;&#x6839;&#x91CA;&#x653E;&#x7684;&#x51B7;&#x6C14;&#xFF0C;&#x6211;&#x4EEC;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x5F3A;&#x5236;&#x8BA9;&#x4ED6;&#x4ECE;&#x6839;&#x91CA;&#x653E;
&#x8FD9;&#x6837;&#xFF0C;&#x5982;&#x679C;&#x76F4;&#x63A5;&#x8FDB;&#x884C;&#x4E0A;&#x8FB9;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x4F1A;&#x591A;&#x4E58;&#x4E0A;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x8BE5;&#x90E8;&#x5206;&#x662F;&#x4ECE;&#x6839;&#x5230;&#x539F;&#x672C;&#x91CA;&#x653E;&#x70B9;&#x7684;&#x503C;
&#x6240;&#x4EE5;&#xFF0C;&#x5BF9;x&#x589E;&#x52A0;it&#xFF0C;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x662F;&#x5BF9;&#x6839;&#x589E;&#x52A0;  it/k[x]
&#x7136;&#x540E;&#x4E3A;&#x4E86;&#x6C42;&#x548C;&#x65B9;&#x4FBF;&#xFF0C;&#x6211;&#x4EEC;&#x5BF9;&#x4E8E;&#x67D0;&#x9897;&#x6811;&#x589E;&#x52A0;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x68F5;&#x6811;&#x7684;&#x63A7;&#x5236;&#x8303;&#x56F4;&#x4EE5;&#x5916;&#x7684;&#x5730;&#x65B9;&#x52A0;&#x4E0A;&#x8D1F;&#x7684;&#x6743;&#x503C;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x7701;&#x4E0B;&#x4E86;&#x4E00;&#x4E2A;&#x51CF;&#x53BB;&#x533A;&#x95F4;&#x5916;&#x7684;&#x503C;&#x7684;&#x64CD;&#x4F5C;&#xFF08;&#x867D;&#x7136;&#x4E5F;&#x5E76;&#x6CA1;&#x6709;&#x65B9;&#x4FBF;&#x591A;&#x5C11;&#x5C31;&#x662F;&#x4E86;&#xFF09;
&#x4EE3;&#x7801;




```cpp 
#include<iostream>
#include<cstdio>
#include<cmath>
#include<queue>
#define N 200000
#define ld long double
#define R register
#define M N*4
 const ld LL=1e-8;
using namespace std;
ld w[M],k[N],f[N];
int root[N],cnt[N],knt,n,m,e,to[M],next[M],head[N];
int l[N],r[N];
queue<int> q;
void buid(int u,int v,ld ll)
{
	next[++e]=head[u],head[u]=e;
	to[e]=v;w[e]=ll;
}
void dfs(int now,ld t)
{
	k[now]=t;
	cnt[now]=++knt;
	l[now]=knt;
	for(int i=head[now];i;i=next[i])
	{
		int j=to[i];
		if(root[j]) continue;
		if(!cnt[j]&&!w[i]) {root[j]=1;q.push(j);continue;}
		if(!cnt[j])
		{
			cnt[j]=1;
			dfs(j,t*w[i]);
		}
	}
	r[now]=knt;
}
int low(int now)
{
	return now&(-now);
}
ld ask(int now)
{
	ld re=0;
	for(int i=now;i;i-=low(i))
	{
		re+=f[i];
	}
	return re;
}
void add(int now,ld it)
{
	for(int i=now;i<=n;i+=low(i))
	{
		f[i]+=it;
	}
}
int main()
{
	scanf("%d",&n);
	for(int i=1;i<n;++i)
	{
		R int u,v;
		R ld ll;
		scanf("%d%d%Lf",&u,&v,&ll);
		buid(u,v,ll);
		buid(v,u,ll);
	}
	root[1]=1;
	q.push(1);
	while(!q.empty())
	{
		int now=q.front();q.pop();
//		cout<<"root "<<now<<endl;
		dfs(now,1.0);
	}
//	for(int i=1;i<=n;++i) cout<<k[i]<<endl;
	scanf("%d",&m);
	for(int i=1;i<=m;++i)
	{
		int fl,u;
		scanf("%d%d",&fl,&u);
		if(fl==9)
		{
			ld ans=ask(cnt[u])*k[u];
			printf("%.8Lf\n",ans);
		}
		else
		{
			ld it;
			scanf("%Lf",&it);
			it/=k[u];
			add(l[u],it);
			add(r[u]+1,-it);
		}
	}
	return 0;
}
``` 
